{% extends "dashboard/dashboard_base.html" %}

{% block title %}ç®¡ç†è€…ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰{% endblock %}
{% block content_title %}ç®¡ç†è€…ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰{% endblock %}
{% block content_meta %}
<p class="subtle">{{ user.username }} ã•ã‚“ï¼ˆãƒ­ã‚°ã‚¤ãƒ³: {{ user.last_login|date:"Yå¹´mæœˆdæ—¥ H:i" }}ï¼‰</p>
{% endblock %}
{% block content %}

<p>åœ°å›³ã®ç·´ç¿’</p>
<!-- Leaflet CSS -->
<link
  rel="stylesheet"
  href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
  integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
  crossorigin=""
/>

<style>
  #map { 
    height: 65vh; 
    border-radius: 12px; 
    box-shadow: 0 4px 16px rgba(0,0,0,.12); 
  }
  .jump-buttons { 
    display: grid; 
    grid-template-columns: repeat(4, 1fr); /* å…¨ä½“ãƒœã‚¿ãƒ³ã‚‚å…¥ã‚‹ã®ã§4åˆ— */
    gap: .5rem; 
    margin-top: .75rem; 
  }
  .jump-buttons button {
    padding: .6rem .8rem;
    border-radius: .75rem;
    border: 1px solid #e5e7eb;
    background: #fff;
    cursor: pointer;
    transition: background .2s;
    font-weight: 600;
  }
  .jump-buttons button:hover { 
    background: #f3f4f6; 
  }
</style>

<div id="map"></div>

<!-- â–¼ åœ°å›³æ“ä½œç”¨ãƒœã‚¿ãƒ³ -->
<div class="jump-buttons">
  <button onclick="resetView()">ğŸ—ºï¸ å…¨ä½“ãƒãƒƒãƒ—è¡¨ç¤º</button>
  <button onclick="flyToSpot('jyouyama')">ğŸ’ åŸå±±å‹•ç‰©åœ’</button>
  <button onclick="flyToSpot('chausuyama')">ğŸ˜ èŒ¶è‡¼å±±å‹•ç‰©åœ’</button>
  <button onclick="flyToSpot('suzaka')">ğŸ¦˜ é ˆå‚å¸‚å‹•ç‰©åœ’</button>
</div>

<!-- â–¼ Googleãƒãƒƒãƒ— / ã‚¹ãƒˆãƒªãƒ¼ãƒˆãƒ“ãƒ¥ãƒ¼ç”¨ãƒœã‚¿ãƒ³ -->
<div class="jump-buttons" style="margin-top:.5rem">
  <button onclick="openStreetView('jyouyama')">ğŸš¶ åŸå±±å‹•ç‰©åœ’ã‚¹ãƒˆãƒªãƒ¼ãƒˆãƒ“ãƒ¥ãƒ¼</button>
  <button onclick="openStreetView('chausuyama')">ğŸš¶ èŒ¶è‡¼å±±å‹•ç‰©åœ’ã‚¹ãƒˆãƒªãƒ¼ãƒˆãƒ“ãƒ¥ãƒ¼</button>
  <button onclick="openStreetView('suzaka')">ğŸš¶ é ˆå‚å¸‚å‹•ç‰©åœ’ã‚¹ãƒˆãƒªãƒ¼ãƒˆãƒ“ãƒ¥ãƒ¼</button>
</div>

<!-- Leaflet JS -->
<script
  src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
  integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
  crossorigin=""
></script>

<script>
  // â–¼ å„å‹•ç‰©åœ’ã®è©³ç´°æƒ…å ±
const spots = [
  {
    id: 'jyouyama',
    name: 'ğŸ’åŸå±±å‹•ç‰©åœ’',

    // â˜… Leafletåœ°å›³ç”¨ï¼ˆä»Šã®ã¾ã¾ï¼‰
    lat: 36.66490806254121,
    lng: 138.1942988606473,
    zoom: 16,

    // â˜… ã‚¹ãƒˆãƒªãƒ¼ãƒˆãƒ“ãƒ¥ãƒ¼å°‚ç”¨ï¼ˆå…¥å£ã®é“ã®å‰ãªã©ï¼‰
    sv_lat: 36.665244588523024, 
    sv_lng: 138.1935118468303,
    sv_heading: 130, 

    address: 'ã€’380-0802 é•·é‡çœŒé•·é‡å¸‚ä¸Šæ¾ï¼’ä¸ç›®ï¼‘âˆ’ï¼‘ï¼™',
    tel: '026-233-0586'
  },
  {
    id: 'chausuyama',
    name: 'ğŸ˜èŒ¶è‡¼å±±å‹•ç‰©åœ’',

    lat: 36.58530392097484,
    lng: 138.11518754155875,
    zoom: 16,

    sv_lat: 36.583904, 
    sv_lng: 138.114083,
    sv_heading: 0, 

    address: 'ã€’388-8016 é•·é‡çœŒé•·é‡å¸‚ç¯ ãƒäº•æœ‰æ—…ï¼•ï¼—ï¼âˆ’ï¼‘',
    tel: '026-293-5167'
  },
  {
    id: 'suzaka',
    name: 'ğŸ¦˜é ˆå‚å¸‚å‹•ç‰©åœ’',

    lat: 36.6423500355432,
    lng: 138.31111727750795,
    zoom: 16,

    sv_lat: 36.643277, 
    sv_lng: 138.311711,
    sv_heading: 180, 

    address: 'ã€’382-0028 é•·é‡çœŒé ˆå‚å¸‚è‡¥ç«œï¼’ä¸ç›®ï¼”âˆ’ï¼˜',
    tel: '026-245-1770'
  }
];


  // åœ°å›³ä½œæˆ
  const map = L.map('map');
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; OpenStreetMap contributors'
  }).addTo(map);

  // ãƒãƒ¼ã‚«ãƒ¼è¿½åŠ 
  const markers = [];
  spots.forEach((s) => {
    const popupContent = `
      <b>${s.name}</b><br>
      ${s.address}<br>
      â˜ ${s.tel}
    `;
    const marker = L.marker([s.lat, s.lng]).addTo(map).bindPopup(popupContent);
    marker.on('click', () => {
      map.flyTo([s.lat, s.lng], s.zoom, { duration: 0.6 });
      marker.openPopup();
    });
    markers.push(marker);
  });

  // å…¨ä½“ãƒ“ãƒ¥ãƒ¼ã‚’è¨ˆç®—
  const group = L.featureGroup(markers);
  const fullBounds = group.getBounds().pad(0.3);
  map.fitBounds(fullBounds);

  // â–¼ ãƒœã‚¿ãƒ³ã§åœ°å›³ã‚’é£›ã¶
  function flyToSpot(id) {
    const s = spots.find(x => x.id === id);
    if (!s) return;
    map.flyTo([s.lat, s.lng], s.zoom, { duration: 0.6 });
    const idx = spots.indexOf(s);
    markers[idx].openPopup();
  }

  // ğŸŒ å…¨ä½“ãƒãƒƒãƒ—ã«æˆ»ã‚‹
  function resetView() {
    map.flyToBounds(fullBounds, { duration: 0.8 });
    map.closePopup(); // ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã‚’é–‰ã˜ã‚‹
  }

function openStreetView(id) {
  const s = spots.find(x => x.id === id);
  if (!s) return;

  const lat = s.sv_lat ?? s.lat;
  const lng = s.sv_lng ?? s.lng;
  const heading = s.sv_heading ?? 0; // æŒ‡å®šãªã‘ã‚Œã°åŒ—å‘ã

  const url =
    `https://www.google.com/maps/@?api=1&map_action=pano` +
    `&viewpoint=${lat},${lng}` +
    `&heading=${heading}&pitch=0&fov=80`;

  window.open(url, '_blank');
}

</script>


{% comment %} <!-- ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç† -->
<section id="users">
  <h2>ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†</h2>
  <div class="grid">
    <div class="card">
      <h3>ä¼šå“¡ä¸€è¦§</h3>
      <ul>
        <li>åŸºæœ¬æƒ…å ±ãƒ»ã‚³ã‚¤ãƒ³ãƒ»ãƒã‚¤ãƒ³ãƒˆãƒ»æœ€çµ‚ãƒ­ã‚°ã‚¤ãƒ³ã‚’è¡¨ç¤º</li>
        <li>æ¤œç´¢ï¼ä¸¦ã³æ›¿ãˆã‚’è¿½åŠ ã—ã¦ã‚‚ã„ã„</li>
      </ul>
    </div>
    <div class="card">
      <h3>â†’ä¼šå“¡è©³ç´°</h3>
      <ul>
        <li>ç·¨é›†ãƒ»é€€ä¼šãƒ»PWãƒªã‚»ãƒƒãƒˆ</li>
        <li>è³¼å…¥å±¥æ­´ãƒ»ãƒã‚¤ãƒ³ãƒˆå¢—æ¸›ãƒ»ã‚µãƒ–ã‚¹ã‚¯çŠ¶æ…‹ç¢ºèª</li>
      </ul>
    </div>
  </div>
</section>

<!-- ã‚µãƒ–ã‚¹ã‚¯ç®¡ç† -->
<section id="subs">
  <h2>ã‚µãƒ–ã‚¹ã‚¯ç®¡ç†</h2>
  <div class="grid">
    <div class="card">
      <h3>åŠ å…¥çŠ¶æ³ä¸€è¦§</h3>
      <ul>
        <li>ãƒ—ãƒ©ãƒ³ãƒ»çŠ¶æ…‹ãƒ»æ¬¡å›æ›´æ–°æ—¥ã§çµã‚Šè¾¼ã¿</li>
        <li>æ‰‹å‹•æœ‰åŠ¹åŒ–ãƒ»è§£ç´„</li>
      </ul>
    </div>
    <div class="card">
      <h3>ç‰¹å…¸ç®¡ç†</h3>
      <ul>
        <li>ç‰¹å…¸ã®ç™»éŒ²/ç·¨é›†ãƒ»æœŸé–“è¨­å®š</li>
      </ul>
    </div>
  </div>
</section>

<!-- ã‚°ãƒƒã‚ºç®¡ç† -->
<section id="goods">
  <h2>ã‚°ãƒƒã‚ºç®¡ç†</h2>
  <div class="grid">
    <div class="card">
      <h3>ã‚°ãƒƒã‚ºä¸€è¦§</h3>
      <ul>
        <li>å•†å“ãƒ»ä¾¡æ ¼ãƒ»åœ¨åº«è¡¨ç¤º</li>
        <li>ç·¨é›†ãƒ»äººæ°—/å£²ä¸Šé †è¡¨ç¤º</li>
        <li>åœ¨åº«ã®å¢—æ¸›</li>
      </ul>
    </div>
    <div class="card">
      <h3>ã‚°ãƒƒã‚ºç™»éŒ²</h3>
      <ul>
        <li>åç§°ãƒ»ä¾¡æ ¼ãƒ»èª¬æ˜ãƒ»ç”»åƒã‚’ç™»éŒ²</li>
      </ul>
    </div>
  </div>
</section>

<!-- æ³¨æ–‡ç®¡ç† -->
<section id="orders">
  <h2>æ³¨æ–‡ç®¡ç†</h2>
  <div class="card">
    <h3>æ³¨æ–‡ä¸€è¦§</h3>
    <ul>
      <li>æ³¨æ–‡æ—¥æ™‚ãƒ»æ³¨æ–‡IDãƒ»ãƒ¦ãƒ¼ã‚¶ãƒ¼ã§è¡¨ç¤º/æ¤œç´¢/ä¸¦ã³æ›¿ãˆ/çŠ¶æ…‹å¤‰æ›´(ç™ºé€å¾…/ç™ºé€æ¸ˆ)</li>
      <li>ã‚­ãƒ£ãƒ³ã‚»ãƒ«â†’è¿”é‡‘ï¼ˆéƒ¨åˆ†/å…¨é¡ï¼‰</li>
    </ul>
  </div>
</section>

<!-- å‹•ç‰©ç®¡ç† -->
<section id="animals">
  <h2>å‹•ç‰©ç®¡ç†</h2>
  <div class="grid">
    <div class="card">
      <h3>å‹•ç‰©ä¸€è¦§</h3>
      <ul>
        <li>åå‰ãƒ»ç¨®é¡ãƒ»å…¬é–‹çŠ¶æ…‹ãƒ»æ¨ã—æ•°ç­‰ã‚’è¡¨ç¤º/æ¤œç´¢/ä¸¦ã³æ›¿ãˆ</li>
      </ul>
    </div>
        <div class="card">
      <h3>â†’å‹•ç‰©è©³ç´°</h3>
      <ul>
        <li>ç·¨é›†/å‰Šé™¤</li>
      </ul>
    </div>
    <div class="card">
      <h3>æ–°è¦ç™»éŒ²</h3>
      <ul>
        <li>åŸºæœ¬æƒ…å ±ãƒ»ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æ–‡ãƒ»ç”»åƒã‚’ç™»éŒ²</li>
        <li>ã‚¿ã‚°è¨­å®šãƒ»å…¬é–‹/éå…¬é–‹ãƒ»äºˆç´„å…¬é–‹</li>
      </ul>
    </div>
  </div>
</section> {% endcomment %}


{% endblock %}
