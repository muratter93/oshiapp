{% extends 'common/base.html' %}
{% load static %}

{% block content %}
<style>
.order-history {
  display: flex;
  flex-wrap: wrap;
  gap: 20px;
  padding: 30px;
}

.order-item {
  width: calc(25% - 20px);
  background: #fff;
  border-radius: 10px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
  padding: 15px;
  display: flex;
  flex-direction: column;
  align-items: center;
}

.order-item img {
  width: 120px;
  height: 120px;
  object-fit: cover;
  border-radius: 8px;
}

.order-item h3 {
  font-size: 1rem;
  margin: 10px 0 5px;
  text-align: center;
}

.order-item p {
  color: #666;
  font-size: 0.9rem;
  margin-bottom: 10px;
}

.order-item form button {
  background-color: #4CAF50;
  color: #fff;
  border: none;
  padding: 8px 12px;
  border-radius: 5px;
  cursor: pointer;
  transition: background-color 0.2s;
}

.order-item form button:hover {
  background-color: #43A047;
}

.pagination {
  text-align: center;
  margin-top: 30px;
}

.pagination span,
.pagination a {
  margin: 0 5px;
  padding: 8px 12px;
  border-radius: 5px;
  background-color: #f1f1f1;
  text-decoration: none;
  color: #333;
}

.pagination .current {
  background-color: #4CAF50;
  color: white;
}
</style>

<div class="order-history">
  {% for item in page_obj %}
  <div class="order-item">
    <h3>{{ item.goods.name }}</h3>
    <img src="{{ item.goods.image.url }}" alt="{{ item.goods.name }}">
    <p>必要スタポ：{{ item.goods.required_stanning_points }}</p>

    <form action="{% url 'goods:add_to_cart' item.goods.id %}" method="post">
      {% csrf_token %}
      <button type="submit">もう一度交換する</button>
    </form>
  </div>
  {% empty %}
  <p>まだ交換履歴がありません。</p>
  {% endfor %}
</div>

<div class="pagination">
  {% if page_obj.has_previous %}
    <a href="?page={{ page_obj.previous_page_number }}">« 前へ</a>
  {% endif %}

  <span class="current">ページ {{ page_obj.number }} / {{ page_obj.paginator.num_pages }}</span>

  {% if page_obj.has_next %}
    <a href="?page={{ page_obj.next_page_number }}">次へ »</a>
  {% endif %}
</div>
{% endblock %}
